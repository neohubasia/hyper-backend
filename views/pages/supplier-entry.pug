extends ../includes/layout-main
block content
  div.modal.fade#AddUserPassDialog(tabindex='-1', role='dialog', aria-labelledby='AddPayment')
    div.modal-dialog.modal-sm(role='document', style='max-width:730px')
      div.modal-content
        div.modal-header
          h4.modal-title 
          button.close(type='button', data-dismiss='modal', aria-label='Close')
            span(aria-hidden='true') &times;
        div.modal-body
          div.form-group.row
            div.col-sm-2.label-data
              label.control-label(for='username') User Name
        div.modal-footer
          button.btn.btn-primary#dialogPaymentAccept(type='button', data-dismiss='modal') Ok
          button.btn.btn-secondary#dialogPaymentCancel(type='button', data-dismiss='modal') Cancel
  main.ml-sm-auto.px-md-4(role='main')
    include ./../includes/layout-entry-header
    include ./../includes/layout-entry-form
      block inputs
        div.form-group.row
          div.col-sm-6.mb-2
            label.control-label(for='company_name') Company Name
            input.form-control.input-sm#company_name(type='text', name='company_name', value=data.company_name, maxlength="55" autocomplete="off" disabled)
          div.col-sm-6.mb-2
            label.control-label(for='contact_name') Contact Name
            input.form-control.input-sm#contact_name(type='text', name='contact_name' value=data.contact_name maxlength="55" autocomplete="off" disabled)

        div.form-group.row
          div.col-sm-6.mb-2
            - var cityid =  data.address_info[0].cityid || "#";
            label.control-label(for='city') City
            select.form-control.input-sm.selectpicker#cityid(name='cityid' value=cityid._id data-value=cityid._id, data-live-search="true", data-size="8" disabled)
          div.col-sm-6.mb-2
            - var townshipid =  data.address_info[0].townshipid || "#";
            label.control-label(for='city') Township
            select.form-control.input-sm.selectpicker#townshipid(name='townshipid' value=townshipid._id data-value=townshipid._id, data-live-search="true", data-size="8" disabled)
        
        div.form-group.row
          div.col-sm-6.mb-2
            label.control-label(for='address') Address
            input.form-control.input-sm#address(type='text', name='address', value=data.address_info[0].address, maxlength="55" autocomplete="off" disabled)
          div.col-sm-6.mb-2
            label.control-label(for='mobile_no') Mobile Phone
            input.form-control.input-sm#mobile_no(type='text', name='mobile_no' value=data.address_info[0].mobile_no maxlength="55" autocomplete="off" disabled)
        
        div.form-group.row
          div.col-sm-6.mb-2
            label.control-label(for='email') Email
            input.form-control.input-sm#email(type='text', name='email', value=data.address_info[0].email, maxlength="55" autocomplete="off" disabled)
          div.col-sm-6.mb-2
            label.control-label(for='website') Website
            input.form-control.input-sm#website(type='text', name='website' value=data.website maxlength="55" autocomplete="off" disabled)
        
        div.form-group.row
          div.col-sm-6.mb-2
            - var product_type_id =  data.product_type_id || "#";
            label.control-label(for='product_type_id') Product Type
            select.form-control.input-sm.selectpicker#product_type_id(name='product_type_id' value=product_type_id._id data-value=product_type_id._id, data-live-search="true", data-size="8" disabled)
          div.col-sm-6.mb-2
            - var payment_method_id =  data.payment_methods[0].payment_method_id || "#";
            label.control-label(for='payment_method') Payment Method
            select.form-control.input-sm.selectpicker#payment_method_id(name='payment_method_id' value=payment_method_id._id data-value=payment_method_id._id, data-live-search="true", data-size="8" disabled)
        
        div.form-group.row
          div.col-sm-6.mb-2
            label.control-label(for='status') Status
            div.radio.radio-toolbar.row
              div.col-sm-6.mb-2.col-xl-3
                input#statusActive.radiobox(type='radio', name='active', value="1" checked)
                label.ml-1(for='statusActive') &nbsp; Active
              div.col-sm-6.mb-2.col-xl-3
                input#statusInactive.radiobox(type='radio', name='active', value="0")
                label.ml-1(for='statusInactive') &nbsp; Inactive
          div.col-sm-6.mb-2
            label.control-label(for='access') Register Access
            div.radio.radio-toolbar.row
              div.col-sm-6.mb-2.col-xl-3
                input#statusAccess.radiobox(type='radio', name='access', value="1" , data-toggle="modal", data-target="#AddUserPassDialog")
                label.ml-1(for='statusAccess') &nbsp; Access
              div.col-sm-6.mb-2.col-xl-3
                input#statusUnaccess.radiobox(type='radio', name='access', value="0" checked)
                label.ml-1(for='statusUnaccess') &nbsp; Unaccess
        div.form-group.row
          div.col-sm-6.mb-2
            label.control-label(for='description') Description
            textarea.form-control.input-sm#description(name='description', disabled autofocus)= data.description
        include ./../includes/layout-entry-btn
  
    form#postSuccessForm(method='GET', action=page.list.url)
  script.
    $(document).ready(function() {
      var token = '!{token}';
      $('#alert').hide();
      console.log("!{data.payment_methods[0].payment_method_id}");
      var status = "!{data.active}";
      if (status && status == "false")
        $('#statusInactive').attr("checked", "checked");

      var statusaccess = "!{data.access}";
      if (statusaccess && statusaccess == "false")
        $('#statusUnaccess').attr("checked", "checked");
      
      ajaxLoadOption({
        type: "GET",
        url:"/api/cities",
        selectId: "#cityid",
        showKey: "city_mm",
        filterObj: {},
        token: token
      });

      ajaxLoadOption({
        type: "GET",
        url:"/api/townships",
        selectId: "#townshipid",
        showKey: "township_mm",
        filterObj: {},
        token: token
      });

      ajaxLoadOption({
        type: "GET",
        url:"/api/payment_methods",
        selectId: "#payment_method_id",
        showKey: "description",
        filterObj: {},
        token: token
      });

      ajaxLoadOption({
        type: "GET",
        url:"/api/product_categories",
        selectId: "#product_type_id",
        showKey: "name",
        filterObj: {},
        token: token
      });

      $('#entryForm').submit(function (e) {
        e.preventDefault();
        $.ajax({
          url: $(this).attr('action'),
          type:$(this).attr('method'),
          data: $(this).serialize(),
          success: function (data) {
            handleAlert(data);
          },
          error: function (data) {
            console.log('An error occurred.');
            console.log(data);
          },
        });
      });

    });